{% extends "DimeTimetrackerFrontendBundle::layout.html.twig" %}

{% block header %}
<form id="activity-track" class="well form-inline">
    <input id="activity-track-input" class="input-full" placeholder="Track your activity (e.g.10:00-12:00 @customer)" type="text">
    <button class="btn btn-primary" type="submit"><i class="icon-play icon-white"></i> Track</button>
</form>
{% endblock %}

{% block content %}
<div id="activities" class="loading"></div>

<script type="text/template" id="tpl-activity-item">
    <% var customerName  = (model.relation('customer')) ? model.relation('customer').get('name')  : '' %>
    <% var customerAlias = (model.relation('customer')) ? model.relation('customer').get('alias') : '' %>

    <div class="btn-toolbar pull-right">
        <% if (model.runningTimeslice()) { %>
        <div class="btn-group">
            <button class="track stop btn btn-danger"><i class="icon-time icon-white"></i></button>
            <button data-duration="<%- data.duration %>" class="duration btn disabled" disabled>(running)</button>
        </div>
        <div class="btn-group">
            <button class="edit btn"><i class="icon-pencil"></i></button>
            <button class="delete btn"><i class="icon-remove-sign"></i></button>
        </div>
        <% } else { %>
        <div class="btn-group">
            <button class="track start btn btn-success"><i class="icon-time icon-white"></i></button>
            <button data-duration="<%- data.duration %>" class="duration btn disabled" disabled><%- model.formatDuration(data.duration) %></button>
        </div>
        <div class="btn-group">
            <button class="edit btn"><i class="icon-pencil"></i></button>
            <button class="delete btn"><i class="icon-remove-sign"></i></button>
        </div>
        <% } %>
    </div>
    <h2><%- data.description %></h2>
    <p><% if (customerAlias.length > 0 && customerName.length > 0) { %>
    <a href="#" class="client-project" data-placement="below" rel="twipsy" title="<%- customerName %>">
        <%- customerAlias %>
    </a>
    <% } %>
    <% if (model.relation('project')) { %>
    / <a href="#"><%- model.relation('project').get('name') %></a>
    <% } %></p>
</script>

{% include 'DimeTimetrackerFrontendBundle:Activities:activityForm.html.twig' %}
{% endblock %}

{% block js %}
<script type="text/javascript">
(function ($, App) {
    var dashboard = new App.Views.Dashboard();
    dashboard.render();
})(jQuery, Dime);
</script>
{% endblock %}
