{% extends "DimeTimetrackerFrontendBundle::layout.html.twig" %}

{% block header %}
<div class="well form-search">
    <input id="activity-track-input" placeholder="Track your activity (e.g.10:00-12:00 @customer)" type="text">
    <button id="activity-track" class="btn btn-primary"><i class="icon-play icon-white"></i> Track</button>
</div>
{% endblock %}

{% block content %}
<table class="table table-striped table-condensed">
    <thead>
        <tr>
            <th>Customer: Project</th>
            <th>Comment</th>
            <th>Duration</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody id="activities">
        <tr>
            <td colspan="4" class="loading"></td>
        </tr>
    </tbody>
</table>

<script type="text/template" id="tpl-activity-item">
    <% var customerName  = (model.relation('customer')) ? model.relation('customer').get('name')  : '' %>
    <% var customerAlias = (model.relation('customer')) ? model.relation('customer').get('alias') : '' %>
    <td>
        <% if (customerAlias.length > 0 && customerName.length > 0) { %>
        <a href="#" class="client-project" data-placement="below" rel="twipsy" title="<%- customerName %>">
            <%- customerAlias %>
        </a>
        <% } %>
        <% if (model.relation('project')) { %>
        <a href="#"><%- model.relation('project').get('name') %></a>
        <% } %>
    </td>
    <td><%- data.description %></td>
    <% if (model.runningTimeslice()) { %>
    <td class="duration" data-duration="<%- data.duration %>">(running)</td>
    <td><button class="track stop btn btn-danger span2">Stop</button></td>
    <% } else { %>
    <td class="duration" data-duration="<%- data.duration %>"><%- model.formatDuration(data.duration) %></td>
    <td><button class="track start btn btn-success span2">Continue</button></td>
    <% } %>
</script>
{% endblock %}    

{% block js %}
<script type="text/javascript">
(function ($, App) {
    var dashboard = new App.Views.Dashboard();
    dashboard.render();
})(jQuery, Dime);
</script>
{% endblock %}
